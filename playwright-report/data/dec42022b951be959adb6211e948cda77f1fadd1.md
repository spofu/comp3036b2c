# Test info

- Name: Protected Routes >> should redirect to login when accessing cart without auth
- Location: C:\Users\henry\OneDrive\Documents\uni\ICT-S4\COMP3036\Major\comp3036b2c\tests\e2e\auth\protected-routes.spec.ts:15:7

# Error details

```
TimeoutError: page.goto: Timeout 10000ms exceeded.
Call log:
  - navigating to "http://localhost:3000/cart", waiting until "load"

    at C:\Users\henry\OneDrive\Documents\uni\ICT-S4\COMP3036\Major\comp3036b2c\tests\e2e\auth\protected-routes.spec.ts:16:16
```

# Test source

```ts
   1 | import { test, expect } from '@playwright/test';
   2 |
   3 | const TEST_USER = {
   4 |   email: 'customer@example.com',
   5 |   password: 'password123'
   6 | };
   7 |
   8 | const ADMIN_USER = {
   9 |   email: 'admin@example.com',
   10 |   password: 'admin123'
   11 | };
   12 |
   13 | test.describe('Protected Routes', () => {
   14 |   
   15 |   test('should redirect to login when accessing cart without auth', async ({ page }) => {
>  16 |     await page.goto('/cart');
      |                ^ TimeoutError: page.goto: Timeout 10000ms exceeded.
   17 |     
   18 |     // Should redirect to login page
   19 |     await expect(page).toHaveURL(/.*login.*/);
   20 |   });
   21 |
   22 |   test('should redirect to login when accessing checkout without auth', async ({ page }) => {
   23 |     await page.goto('/checkout');
   24 |     
   25 |     // Should redirect to login page
   26 |     await expect(page).toHaveURL(/.*login.*/);
   27 |   });
   28 |
   29 |   test('should redirect to login when accessing admin without auth', async ({ page }) => {
   30 |     await page.goto('/admin');
   31 |     
   32 |     // Should redirect to login page
   33 |     await expect(page).toHaveURL(/.*login.*/);
   34 |   });
   35 |
   36 |   test('should allow access to cart after login', async ({ page }) => {
   37 |     // Login first
   38 |     await page.goto('/login');
   39 |     await page.fill('input[type="email"]', TEST_USER.email);
   40 |     await page.fill('input[type="password"]', TEST_USER.password);
   41 |     await page.click('button[type="submit"]');
   42 |     
   43 |     // Now try to access cart
   44 |     await page.goto('/cart');
   45 |     await expect(page).toHaveURL('/cart');
   46 |     await expect(page.locator('h1')).toContainText('Cart');
   47 |   });
   48 |
   49 |   test('should allow access to checkout after login', async ({ page }) => {
   50 |     // Login first
   51 |     await page.goto('/login');
   52 |     await page.fill('input[type="email"]', TEST_USER.email);
   53 |     await page.fill('input[type="password"]', TEST_USER.password);
   54 |     await page.click('button[type="submit"]');
   55 |     
   56 |     // Now try to access checkout
   57 |     await page.goto('/checkout');
   58 |     await expect(page).toHaveURL('/checkout');
   59 |     await expect(page.locator('h1')).toContainText('Checkout');
   60 |   });
   61 |
   62 |   test('should deny admin access to regular user', async ({ page }) => {
   63 |     // Login as regular user
   64 |     await page.goto('/login');
   65 |     await page.fill('input[type="email"]', TEST_USER.email);
   66 |     await page.fill('input[type="password"]', TEST_USER.password);
   67 |     await page.click('button[type="submit"]');
   68 |     
   69 |     // Try to access admin
   70 |     await page.goto('/admin');
   71 |     
   72 |     // Should be redirected or show access denied
   73 |     await expect(page).not.toHaveURL('/admin');
   74 |   });
   75 |
   76 |   test('should allow admin access to admin user', async ({ page }) => {
   77 |     // Login as admin
   78 |     await page.goto('/login');
   79 |     await page.fill('input[type="email"]', ADMIN_USER.email);
   80 |     await page.fill('input[type="password"]', ADMIN_USER.password);
   81 |     await page.click('button[type="submit"]');
   82 |     
   83 |     // Try to access admin
   84 |     await page.goto('/admin');
   85 |     await expect(page).toHaveURL('/admin');
   86 |     await expect(page.locator('h1')).toContainText('Admin');
   87 |   });
   88 |
   89 |   test('should maintain auth state across page navigation', async ({ page }) => {
   90 |     // Login
   91 |     await page.goto('/login');
   92 |     await page.fill('input[type="email"]', TEST_USER.email);
   93 |     await page.fill('input[type="password"]', TEST_USER.password);
   94 |     await page.click('button[type="submit"]');
   95 |     
   96 |     // Navigate to different pages
   97 |     await page.goto('/');
   98 |     await expect(page.locator('text=Logout')).toBeVisible();
   99 |     
  100 |     await page.goto('/cart');
  101 |     await expect(page.locator('text=Logout')).toBeVisible();
  102 |     
  103 |     await page.goto('/search');
  104 |     await expect(page.locator('text=Logout')).toBeVisible();
  105 |   });
  106 |
  107 |   test('should clear auth state after logout', async ({ page }) => {
  108 |     // Login
  109 |     await page.goto('/login');
  110 |     await page.fill('input[type="email"]', TEST_USER.email);
  111 |     await page.fill('input[type="password"]', TEST_USER.password);
  112 |     await page.click('button[type="submit"]');
  113 |     
  114 |     // Logout
  115 |     await page.click('text=Logout');
  116 |     
```