# Test info

- Name: Authentication System >> Authentication flow: login → logout → register → validation
- Location: C:\Users\henry\OneDrive\Documents\uni\ICT-S4\COMP3036\Major\comp3036b2c\tests\e2e\auth\optimized-auth.spec.ts:12:7

# Error details

```
TimeoutError: page.click: Timeout 5000ms exceeded.
Call log:
  - waiting for locator('[data-testid="login-button"]')

    at C:\Users\henry\OneDrive\Documents\uni\ICT-S4\COMP3036\Major\comp3036b2c\tests\e2e\auth\optimized-auth.spec.ts:15:16
```

# Page snapshot

```yaml
- banner:
  - navigation:
    - link "CLOOOOTHES":
      - /url: /
      - paragraph: CLOOOOTHES
    - textbox "Search products..."
    - link "Shopping Cart":
      - /url: /cart
      - img "Shopping Cart"
    - link "Login":
      - /url: /login
- main:
  - heading "Our Products" [level=2]
  - text: "Category:"
  - combobox "Category:":
    - option "All Categories" [selected]
    - option "Men's T-Shirts"
    - option "Men's Jackets"
    - option "Men's Pants"
    - option "Men's Polo Shirts"
    - option "Men's Hoodies"
  - text: "Sort by:"
  - combobox "Sort by:":
    - option "Name (A-Z)" [selected]
    - option "Price (Low to High)"
    - option "Price (High to Low)"
  - paragraph: 8 products found
  - link "Business Casual Chino Pants Men's Pants Business Casual Chino Pants $59.99 Versatile cotton chino pants perfect for office or casual occasions":
    - /url: /product/768a10fb-202a-4d8c-8974-1e101f3252dc
    - img "Business Casual Chino Pants"
    - text: Men's Pants
    - heading "Business Casual Chino Pants" [level=3]
    - paragraph: $59.99
    - paragraph: Versatile cotton chino pants perfect for office or casual occasions
  - text: "Size:"
  - combobox:
    - option "30" [selected]
    - option "32"
    - option "34"
  - text: "Color:"
  - combobox:
    - option "Khaki" [selected]
    - option "Gray"
  - button "Add to Cart"
  - link "Classic Cotton Crew Neck T-Shirt Men's T-Shirts Classic Cotton Crew Neck T-Shirt $24.99 Premium 100% cotton crew neck tee with comfortable fit and durable construction":
    - /url: /product/374869b7-a5da-4c5d-aca5-63e583fce6fb
    - img "Classic Cotton Crew Neck T-Shirt"
    - text: Men's T-Shirts
    - heading "Classic Cotton Crew Neck T-Shirt" [level=3]
    - paragraph: $24.99
    - paragraph: Premium 100% cotton crew neck tee with comfortable fit and durable construction
  - text: "Size:"
  - combobox:
    - option "L" [selected]
    - option "M"
    - option "S"
    - option "XL"
  - text: "Color:"
  - combobox:
    - option "Black" [selected]
    - option "White"
  - button "Add to Cart"
  - link "Classic Pique Polo Shirt Men's Polo Shirts Classic Pique Polo Shirt $39.99 Traditional pique cotton polo with three-button placket and ribbed collar":
    - /url: /product/d32ea47b-1df3-4709-8bdd-8c8f53e1eaea
    - img "Classic Pique Polo Shirt"
    - text: Men's Polo Shirts
    - heading "Classic Pique Polo Shirt" [level=3]
    - paragraph: $39.99
    - paragraph: Traditional pique cotton polo with three-button placket and ribbed collar
  - text: "Size:"
  - combobox:
    - option "L" [selected]
    - option "M"
    - option "S"
    - option "XL"
  - text: "Color:"
  - combobox:
    - option "Navy" [selected]
    - option "White"
  - button "Add to Cart"
  - link "Genuine Leather Biker Jacket Men's Jackets Genuine Leather Biker Jacket $249.99 Premium genuine leather jacket with quilted shoulders and multiple pockets":
    - /url: /product/79460506-1f3c-43b3-952b-558762f6bab6
    - img "Genuine Leather Biker Jacket"
    - text: Men's Jackets
    - heading "Genuine Leather Biker Jacket" [level=3]
    - paragraph: $249.99
    - paragraph: Premium genuine leather jacket with quilted shoulders and multiple pockets
  - text: "Size:"
  - combobox:
    - option "L" [selected]
    - option "M"
    - option "XL"
  - text: "Color:"
  - combobox:
    - option "Black" [selected]
    - option "Brown"
  - button "Add to Cart"
  - link "Pullover Fleece Hoodie Men's Hoodies Pullover Fleece Hoodie $54.99 Cozy fleece-lined pullover hoodie with kangaroo pocket and drawstring hood":
    - /url: /product/f94066d2-a2f7-4e65-a0ab-f619b3f035ab
    - img "Pullover Fleece Hoodie"
    - text: Men's Hoodies
    - heading "Pullover Fleece Hoodie" [level=3]
    - paragraph: $54.99
    - paragraph: Cozy fleece-lined pullover hoodie with kangaroo pocket and drawstring hood
  - text: "Size:"
  - combobox:
    - option "L" [selected]
    - option "M"
    - option "S"
    - option "XL"
  - text: "Color:"
  - combobox:
    - option "Black" [selected]
    - option "Gray"
  - button "Add to Cart"
  - link "Slim Fit Dark Wash Jeans Men's Pants Slim Fit Dark Wash Jeans $79.99 Premium denim jeans with slim fit, dark wash, and comfortable stretch":
    - /url: /product/5d0b5705-7ac5-465b-bbbe-685ef36fd82d
    - img "Slim Fit Dark Wash Jeans"
    - text: Men's Pants
    - heading "Slim Fit Dark Wash Jeans" [level=3]
    - paragraph: $79.99
    - paragraph: Premium denim jeans with slim fit, dark wash, and comfortable stretch
  - text: "Size:"
  - combobox:
    - option "30" [selected]
    - option "32"
    - option "34"
    - option "36"
  - text: "Color:"
  - combobox:
    - option "Blue" [selected]
    - option "Black"
  - button "Add to Cart"
  - link "Vintage Graphic Print T-Shirt Men's T-Shirts Vintage Graphic Print T-Shirt $29.99 Retro-style graphic tee with distressed print and soft-wash finish":
    - /url: /product/12082741-8494-4708-9709-91e4d328e7ca
    - img "Vintage Graphic Print T-Shirt"
    - text: Men's T-Shirts
    - heading "Vintage Graphic Print T-Shirt" [level=3]
    - paragraph: $29.99
    - paragraph: Retro-style graphic tee with distressed print and soft-wash finish
  - text: "Size:"
  - combobox:
    - option "L" [selected]
    - option "M"
    - option "S"
    - option "XL"
  - text: "Color:"
  - combobox:
    - option "Gray" [selected]
    - option "Navy"
  - button "Add to Cart"
  - link "Waterproof Rain Jacket Men's Jackets Waterproof Rain Jacket $89.99 Lightweight waterproof jacket with breathable fabric and adjustable hood":
    - /url: /product/25737052-b5cf-4c07-a222-772099ac92b8
    - img "Waterproof Rain Jacket"
    - text: Men's Jackets
    - heading "Waterproof Rain Jacket" [level=3]
    - paragraph: $89.99
    - paragraph: Lightweight waterproof jacket with breathable fabric and adjustable hood
  - text: "Size:"
  - combobox:
    - option "L" [selected]
    - option "M"
    - option "XL"
  - text: "Color:"
  - combobox:
    - option "Black" [selected]
    - option "Navy"
  - button "Add to Cart"
- contentinfo:
  - contentinfo:
    - heading "CLOOOOTHES" [level=3]
    - paragraph: Discover the latest trends in fashion with our curated collections for men, women, and kids.
    - link "Facebook":
      - /url: "#"
    - link "Instagram":
      - /url: "#"
    - link "Twitter":
      - /url: "#"
    - heading "Shop" [level=3]
    - list:
      - listitem:
        - link "Shop our collection.":
          - /url: /
    - heading "Support" [level=3]
    - list:
      - listitem:
        - link "Contact Us":
          - /url: /contact
      - listitem:
        - link "FAQ":
          - /url: /faq
      - listitem:
        - link "Shipping & Returns":
          - /url: /shipping
      - listitem:
        - link "Size Guide":
          - /url: /size-guide
      - listitem:
        - link "Track Order":
          - /url: /track-order
    - heading "Contact" [level=3]
    - paragraph:
      - img
      - text: 123 Fashion Street, London, UK
    - paragraph:
      - img
      - text: +44 1234 567890
    - paragraph:
      - img
      - text: support@ecommercetype.com
    - text: VISA MC AMEX PayPal Apple
    - paragraph: © 2025 E-Commerce Type Shii. All rights reserved.
    - link "Privacy Policy":
      - /url: /privacy
    - link "Terms of Service":
      - /url: /terms
    - link "Returns Policy":
      - /url: /returns
- alert
- button "Open Next.js Dev Tools":
  - img
```

# Test source

```ts
   1 | import { test, expect } from '@playwright/test';
   2 | import { TestHelpers } from '../fixtures/testHelpers';
   3 | import { testUsers } from '../fixtures/testData';
   4 |
   5 | test.describe('Authentication System', () => {
   6 |   let helpers: TestHelpers;
   7 |
   8 |   test.beforeEach(async ({ page }) => {
   9 |     helpers = new TestHelpers(page);
   10 |   });
   11 |
   12 |   test('Authentication flow: login → logout → register → validation', async ({ page }) => {
   13 |     // Step 1: Valid login
   14 |     await page.goto('/');
>  15 |     await page.click('[data-testid="login-button"]');
      |                ^ TimeoutError: page.click: Timeout 5000ms exceeded.
   16 |     
   17 |     await page.fill('[data-testid="login-email"]', testUsers.validUser.email);
   18 |     await page.fill('[data-testid="login-password"]', testUsers.validUser.password);
   19 |     await page.click('[data-testid="login-submit"]');
   20 |     
   21 |     // Verify login success
   22 |     await expect(page.locator('[data-testid="user-menu"]')).toBeVisible({ timeout: 3000 });
   23 |     
   24 |     // Step 2: Logout
   25 |     await page.click('[data-testid="user-menu"]');
   26 |     await page.click('[data-testid="logout-button"]');
   27 |     await expect(page.locator('[data-testid="login-button"]')).toBeVisible({ timeout: 2000 });
   28 |     
   29 |     // Step 3: Invalid login attempt
   30 |     await page.click('[data-testid="login-button"]');
   31 |     await page.fill('[data-testid="login-email"]', 'invalid@example.com');
   32 |     await page.fill('[data-testid="login-password"]', 'wrongpassword');
   33 |     await page.click('[data-testid="login-submit"]');
   34 |     
   35 |     // Verify error message
   36 |     await expect(page.locator('[data-testid="error-message"]')).toBeVisible();
   37 |     
   38 |     // Step 4: Registration with validation
   39 |     await page.click('[data-testid="switch-to-register"]');
   40 |     
   41 |     // Test empty fields validation
   42 |     await page.click('[data-testid="register-submit"]');
   43 |     await expect(page.locator('[data-testid="validation-error"]')).toBeVisible();
   44 |     
   45 |     // Test invalid email format
   46 |     await page.fill('[data-testid="register-email"]', 'invalid-email');
   47 |     await page.click('[data-testid="register-submit"]');
   48 |     await expect(page.locator('[data-testid="validation-error"]')).toBeVisible();
   49 |     
   50 |     // Step 5: Password visibility toggle
   51 |     await page.fill('[data-testid="register-password"]', 'testpass');
   52 |     const passwordField = page.locator('[data-testid="register-password"]');
   53 |     
   54 |     // Initially password should be hidden
   55 |     expect(await passwordField.getAttribute('type')).toBe('password');
   56 |     
   57 |     // Toggle visibility
   58 |     await page.click('[data-testid="toggle-password"]');
   59 |     expect(await passwordField.getAttribute('type')).toBe('text');
   60 |     
   61 |     // Verify all authentication features work
   62 |     expect(await page.locator('[data-testid="login-button"]').isVisible()).toBe(true);
   63 |   });
   64 |
   65 |   test('Admin authentication and authorization', async ({ page }) => {
   66 |     // Step 1: Admin login
   67 |     await helpers.loginUser(testUsers.admin);
   68 |     
   69 |     // Step 2: Access admin routes
   70 |     await page.goto('/admin');
   71 |     await expect(page.locator('[data-testid="admin-dashboard"]')).toBeVisible();
   72 |     
   73 |     // Step 3: Verify admin-only features
   74 |     await expect(page.locator('[data-testid="admin-products-link"]')).toBeVisible();
   75 |     await expect(page.locator('[data-testid="admin-orders-link"]')).toBeVisible();
   76 |     
   77 |     // Step 4: Logout and verify access restriction
   78 |     await helpers.logout();
   79 |     
   80 |     // Try to access admin route as guest
   81 |     await page.goto('/admin');
   82 |     await page.waitForURL('/login');
   83 |     
   84 |     // Step 5: Login as regular user and verify no admin access
   85 |     await helpers.loginUser(testUsers.validUser);
   86 |     await page.goto('/admin');
   87 |     
   88 |     // Should redirect or show unauthorized
   89 |     const isRedirected = page.url().includes('/login') || page.url() === '/';
   90 |     const hasUnauthorized = await page.locator('[data-testid="unauthorized"]').isVisible().catch(() => false);
   91 |     
   92 |     expect(isRedirected || hasUnauthorized).toBe(true);
   93 |   });
   94 |
   95 |   test('Protected routes and redirects', async ({ page }) => {
   96 |     // Step 1: Try accessing protected route without login
   97 |     await page.goto('/checkout');
   98 |     await page.waitForURL('/login');
   99 |     
  100 |     // Step 2: Login and verify redirect to intended page
  101 |     await page.fill('[data-testid="login-email"]', testUsers.validUser.email);
  102 |     await page.fill('[data-testid="login-password"]', testUsers.validUser.password);
  103 |     await page.click('[data-testid="login-submit"]');
  104 |     
  105 |     // Should redirect back to checkout after login
  106 |     await page.waitForURL('/checkout');
  107 |     
  108 |     // Step 3: Verify other protected routes
  109 |     const protectedRoutes = ['/order-summary', '/admin'];
  110 |     
  111 |     for (const route of protectedRoutes) {
  112 |       await helpers.logout();
  113 |       await page.goto(route);
  114 |       
  115 |       // Should redirect to login
```