# Test info

- Name: Checkout and Payment System >> Multiple payment methods and billing addresses
- Location: C:\Users\henry\OneDrive\Documents\uni\ICT-S4\COMP3036\Major\comp3036b2c\tests\e2e\checkout\optimized-checkout.spec.ts:164:7

# Error details

```
TimeoutError: page.goto: Timeout 10000ms exceeded.
Call log:
  - navigating to "http://localhost:3000/", waiting until "load"

    at TestHelpers.loginUser (C:\Users\henry\OneDrive\Documents\uni\ICT-S4\COMP3036\Major\comp3036b2c\tests\e2e\fixtures\testHelpers.ts:19:21)
    at C:\Users\henry\OneDrive\Documents\uni\ICT-S4\COMP3036\Major\comp3036b2c\tests\e2e\checkout\optimized-checkout.spec.ts:165:19
```

# Test source

```ts
   1 | import { Page, expect } from '@playwright/test';
   2 | import { testUsers, testAddresses, testPayment } from './testData';
   3 |
   4 | export class TestHelpers {
   5 |   constructor(private page: Page) {}
   6 |
   7 |   // Smart wait helper - waits for condition with fast polling
   8 |   async waitForCondition(condition: () => Promise<boolean>, timeout = 5000) {
   9 |     const startTime = Date.now();
   10 |     while (Date.now() - startTime < timeout) {
   11 |       if (await condition()) return true;
   12 |       await this.page.waitForTimeout(50); // Fast polling every 50ms
   13 |     }
   14 |     throw new Error('Condition not met within timeout');
   15 |   }
   16 |
   17 |   // Authentication helpers with smart waits
   18 |   async loginUser(user = testUsers.validUser) {
>  19 |     await this.page.goto('/');
      |                     ^ TimeoutError: page.goto: Timeout 10000ms exceeded.
   20 |     
   21 |     // Wait for page to be interactive
   22 |     await this.page.waitForLoadState('networkidle');
   23 |     
   24 |     await this.page.click('[data-testid="login-button"]');
   25 |     await this.page.fill('[data-testid="login-email"]', user.email);
   26 |     await this.page.fill('[data-testid="login-password"]', user.password);
   27 |     await this.page.click('[data-testid="login-submit"]');
   28 |     
   29 |     // Smart wait for login success
   30 |     await expect(this.page.locator('[data-testid="user-menu"]')).toBeVisible({ timeout: 3000 });
   31 |   }
   32 |
   33 |   async logout() {
   34 |     await this.page.click('[data-testid="user-menu"]');
   35 |     await this.page.click('[data-testid="logout-button"]');
   36 |     await expect(this.page.locator('[data-testid="login-button"]')).toBeVisible({ timeout: 2000 });
   37 |   }
   38 |
   39 |   // Product helpers
   40 |   async addProductToCart(productId: string, quantity = 1, size = 'M', color = 'Red') {
   41 |     await this.page.goto(`/product/${productId}`);
   42 |     
   43 |     if (await this.page.locator('[data-testid="size-selector"]').isVisible()) {
   44 |       await this.page.selectOption('[data-testid="size-selector"]', size);
   45 |     }
   46 |     
   47 |     if (await this.page.locator('[data-testid="color-selector"]').isVisible()) {
   48 |       await this.page.selectOption('[data-testid="color-selector"]', color);
   49 |     }
   50 |
   51 |     // Set quantity
   52 |     await this.page.fill('[data-testid="quantity-input"]', quantity.toString());
   53 |     
   54 |     await this.page.click('[data-testid="add-to-cart"]');
   55 |     
   56 |     // Wait for success message
   57 |     await expect(this.page.locator('[data-testid="cart-success"]')).toBeVisible();
   58 |   }
   59 |
   60 |   async goToCart() {
   61 |     await this.page.click('[data-testid="cart-icon"]');
   62 |     await expect(this.page).toHaveURL('/cart');
   63 |   }
   64 |
   65 |   async updateCartItemQuantity(itemId: string, newQuantity: number) {
   66 |     const quantityInput = this.page.locator(`[data-testid="cart-item-${itemId}"] [data-testid="quantity-input"]`);
   67 |     await quantityInput.fill(newQuantity.toString());
   68 |     await this.page.keyboard.press('Enter');
   69 |     
   70 |     // Wait for update
   71 |     await this.page.waitForTimeout(1000);
   72 |   }
   73 |
   74 |   async removeCartItem(itemId: string) {
   75 |     await this.page.click(`[data-testid="cart-item-${itemId}"] [data-testid="remove-button"]`);
   76 |     
   77 |     // Wait for removal
   78 |     await expect(this.page.locator(`[data-testid="cart-item-${itemId}"]`)).not.toBeVisible();
   79 |   }
   80 |
   81 |   async clearCart() {
   82 |     await this.goToCart();
   83 |     await this.page.click('[data-testid="clear-cart"]');
   84 |     
   85 |     // Confirm if there's a confirmation dialog
   86 |     if (await this.page.locator('[data-testid="confirm-clear"]').isVisible()) {
   87 |       await this.page.click('[data-testid="confirm-clear"]');
   88 |     }
   89 |     
   90 |     await expect(this.page.locator('[data-testid="empty-cart"]')).toBeVisible();
   91 |   }
   92 |
   93 |   // Checkout helpers
   94 |   async proceedToCheckout() {
   95 |     await this.goToCart();
   96 |     await this.page.click('[data-testid="checkout-button"]');
   97 |     await expect(this.page).toHaveURL('/checkout');
   98 |   }
   99 |
  100 |   async fillShippingAddress(address = testAddresses.valid) {
  101 |     await this.page.fill('[data-testid="shipping-street"]', address.street);
  102 |     await this.page.fill('[data-testid="shipping-apartment"]', address.apartment);
  103 |     await this.page.fill('[data-testid="shipping-city"]', address.city);
  104 |     await this.page.fill('[data-testid="shipping-state"]', address.state);
  105 |     await this.page.fill('[data-testid="shipping-zipcode"]', address.zipCode);
  106 |     await this.page.fill('[data-testid="shipping-country"]', address.country);
  107 |   }
  108 |
  109 |   async fillPaymentInfo(payment = testPayment.card) {
  110 |     await this.page.selectOption('[data-testid="payment-method"]', payment.method);
  111 |     await this.page.fill('[data-testid="card-number"]', payment.cardNumber);
  112 |     await this.page.fill('[data-testid="card-expiry"]', payment.expiryDate);
  113 |     await this.page.fill('[data-testid="card-cvv"]', payment.cvv);
  114 |     await this.page.fill('[data-testid="card-name"]', payment.name);
  115 |   }
  116 |
  117 |   async completeCheckout() {
  118 |     await this.page.click('[data-testid="place-order"]');
  119 |     
```